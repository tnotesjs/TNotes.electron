# [0016. é€‚é… Windows å’Œ macOS ä¸Šçš„çª—å£äº¤äº’è¡Œä¸º](https://github.com/Tdahuyou/electron/tree/main/0016.%20%E9%80%82%E9%85%8D%20Windows%20%E5%92%8C%20macOS%20%E4%B8%8A%E7%9A%84%E7%AA%97%E5%8F%A3%E4%BA%A4%E4%BA%92%E8%A1%8C%E4%B8%BA)

<!-- region:toc -->
- [1. ğŸ” å®˜æ–¹æ–‡æ¡£ - æŸ¥çœ‹ä¸»è¿›ç¨‹çš„ app æ¨¡å—ä¸Šçš„ activateã€window-all-closed äº‹ä»¶çš„ç›¸å…³æè¿°](#1--å®˜æ–¹æ–‡æ¡£---æŸ¥çœ‹ä¸»è¿›ç¨‹çš„-app-æ¨¡å—ä¸Šçš„-activatewindow-all-closed-äº‹ä»¶çš„ç›¸å…³æè¿°)
- [2. ğŸ’» demos.1 - é€‚é… Windows å’Œ macOS ä¸Šçš„çª—å£äº¤äº’è¡Œä¸º](#2--demos1---é€‚é…-windows-å’Œ-macos-ä¸Šçš„çª—å£äº¤äº’è¡Œä¸º)
<!-- endregion:toc -->
- é€‚é… Windows å’Œ macOS ä¸Šçš„çª—å£äº¤äº’è¡Œä¸ºçš„å¤„ç†é€»è¾‘å¾ˆç®€å•ï¼Œé‡ç‚¹åœ¨äºç†è§£ä¸¤ç§ç³»ç»Ÿä¸­çª—å£äº¤äº’çš„ä¸€äº›å·®å¼‚ç‚¹ã€‚

## 1. ğŸ” å®˜æ–¹æ–‡æ¡£ - æŸ¥çœ‹ä¸»è¿›ç¨‹çš„ app æ¨¡å—ä¸Šçš„ activateã€window-all-closed äº‹ä»¶çš„ç›¸å…³æè¿°

- https://www.electronjs.org/zh/docs/latest/api/app#%E4%BA%8B%E4%BB%B6-activate-macos
- https://www.electronjs.org/zh/docs/latest/api/app#%E4%BA%8B%E4%BB%B6-window-all-closed
- äº‹ä»¶: 'activate'
  - å½“åº”ç”¨è¢«æ¿€æ´»æ—¶è§¦å‘ã€‚
- äº‹ä»¶: 'window-all-closed'
  - å½“æ‰€æœ‰çš„çª—å£éƒ½è¢«å…³é—­æ—¶è§¦å‘ã€‚
  - å¦‚æœä½ æ²¡æœ‰ç›‘å¬æ­¤äº‹ä»¶å¹¶ä¸”æ‰€æœ‰çª—å£éƒ½å…³é—­äº†ï¼Œé»˜è®¤çš„è¡Œä¸ºæ˜¯æ§åˆ¶é€€å‡ºç¨‹åºï¼›ä½†å¦‚æœä½ ç›‘å¬äº†æ­¤äº‹ä»¶ï¼Œä½ å¯ä»¥æ§åˆ¶æ˜¯å¦é€€å‡ºç¨‹åºã€‚
- åœ¨æ¡Œé¢ç«¯ï¼ŒmacOS å’Œ Windows æœ‰ç€ç‰¹åˆ«å¤šçš„æ“ä½œå·®å¼‚æ€§
  - åœ¨çª—å£ç®¡ç†ä¸Šï¼ŒWindows ç”¨æˆ·ä¹ æƒ¯ä½¿ç”¨æœ€å¤§åŒ–ã€æœ€å°åŒ–å’Œå…³é—­çª—å£çš„æŒ‰é’®ï¼Œè€Œ macOS ç”¨æˆ·åˆ™é€šå¸¸ä½¿ç”¨ï¼ˆäº¤é€šç¯ï¼‰çº¢ã€é»„ã€ç»¿è‰²çš„æŒ‰é’®åˆ†åˆ«è¡¨ç¤ºå…³é—­ã€æœ€å°åŒ–å’Œå…¨å±ã€‚
  - **åœ¨ macOS ä¸­ï¼Œå³ä½¿æ‰€æœ‰çª—å£å…³é—­äº†ï¼Œåº”ç”¨ä»ç„¶åœ¨åº•éƒ¨çš„èœå•æ ä¸­ä¿æŒæ´»åŠ¨çŠ¶æ€**ã€‚
  - **åœ¨å…¶ä»–å¹³å°ï¼ˆå¦‚ Windows æˆ– Linuxï¼‰ä¸­ï¼Œå…³é—­æœ€åä¸€ä¸ªçª—å£æ—¶ï¼Œé»˜è®¤ä¼šé€€å‡ºåº”ç”¨ç¨‹åº**ã€‚
- éœ€è¦é€‚é…çš„æ•´ä½“è¡Œä¸ºï¼š
  - æ‰€æœ‰çª—å£å…³é—­æ—¶ï¼šåº”ç”¨ä¼šåœ¨ **é macOS ç³»ç»Ÿ** ä¸­é€€å‡ºã€‚åœ¨ macOS ä¸­ï¼Œåº”ç”¨ä¼šä¿æŒåå°è¿è¡Œï¼Œç›´åˆ°ç”¨æˆ·æ˜ç¡®é€€å‡ºåº”ç”¨ã€‚
  - åº”ç”¨è¢«æ¿€æ´» `activate` æ—¶ï¼šå¦‚æœæ²¡æœ‰æ‰“å¼€çª—å£ï¼ˆä¾‹å¦‚ç”¨æˆ·é€šè¿‡ Dock æˆ–ä»»åŠ¡æ ç‚¹å‡»å›¾æ ‡ï¼Œä½†æ²¡æœ‰çª—å£æ‰“å¼€ï¼‰ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ `createWindow()` åˆ›å»ºä¸€ä¸ªæ–°çš„çª—å£ã€‚
    - è¿™æ˜¯ macos ç‰¹æœ‰çš„äº‹ä»¶

```js
// å½“çª—å£éƒ½è¢«å…³é—­äº†
app.on('window-all-closed', () => {
  // å¦‚æœä¸æ˜¯ macOS
  if (process.platform !== 'darwin') {
    // åº”ç”¨é€€å‡º
    app.quit();
  }
});

// macOS ç‰¹å®šè¡Œä¸ºï¼šå½“æ²¡æœ‰çª—å£æ‰“å¼€æ—¶ç‚¹å‡»åº”ç”¨å›¾æ ‡æ‰“å¼€æ–°çª—å£
app.on('activate', () => {
  if (BrowserWindow.getAllWindows().length === 0) {
    createWindow();
  }
});
```

- åœ¨ Windows/Linux ä¸Šå…³é—­æ‰€æœ‰çª—å£æ—¶åº”ç”¨é€€å‡ºã€‚
- åœ¨ macOS ä¸Šï¼Œåº”ç”¨ä¼šä¿æŒåœ¨åå°è¿è¡Œï¼Œè€Œä¸æ˜¯å®Œå…¨é€€å‡ºã€‚
  - å½“ç”¨æˆ·ç‚¹å‡»åº”ç”¨å›¾æ ‡æ—¶ï¼Œå³ä½¿æ²¡æœ‰çª—å£ï¼Œåº”ç”¨ä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çª—å£ã€‚

## 2. ğŸ’» demos.1 - é€‚é… Windows å’Œ macOS ä¸Šçš„çª—å£äº¤äº’è¡Œä¸º

::: code-group

```js [index.js]
const {app, BrowserWindow} = require('electron');

let win;

function createWindow() {
  win = new BrowserWindow();

  win.loadFile('./index.html');

  // å½“çª—å£å…³é—­æ—¶æ¸…é™¤ win å¯¹è±¡
  win.on('closed', () => win = null);
}

app.on('window-all-closed', () => {
  // macOS çš„å¸¸è§„è¡Œä¸ºæ˜¯åº”ç”¨åŠå…¶èœå•æ ç»§ç»­æ¿€æ´»ï¼Œç›´åˆ°ç”¨æˆ·ä½¿ç”¨ Cmd + Q æ˜ç¡®é€€å‡º
  if (process.platform !== 'darwin') {
    app.quit();
  }
});

app.whenReady().then(createWindow);

// macOS ç‰¹å®šè¡Œä¸ºï¼šå½“æ²¡æœ‰çª—å£æ‰“å¼€æ—¶ç‚¹å‡»åº”ç”¨å›¾æ ‡æ‰“å¼€æ–°çª—å£
app.on('activate', () => {
  if (BrowserWindow.getAllWindows().length === 0) {
    createWindow();
  }
});
```

:::